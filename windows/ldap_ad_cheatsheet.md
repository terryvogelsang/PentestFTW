# Active Directory LDAP Commands Cheatsheet

## Search for administrators in groups Domain Admins, Enterprise Admins:
```
(objectClass=user)(objectCategory=Person)(adminCount=1)
```

## List all AD users except blocked ones:
```
(objectCategory=person)(objectClass=user)(!useraccountcontrol:1.2.840.113556.1.4.803:=2)
```

## Display the list of disabled user accounts:
```
(objectCategory=person)(objectClass=user)(useraccountcontrol:1.2.840.113556.1.4.803:=16)
```

## Select users with the “Password never expires option” enabled:
```
(objectcategory=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)
```

## Users with empty email value:
```
(objectcategory=person)(!mail=*)
```

## List users with the Sales specified in the Department field:
```
(&(objectCategory=person)(objectClass=user)(department=Sales))
```

## You can get a list of users with membership in a specific Active Directory group:
```
(&(objectclass=user)(samacccountname=*)(MemberOf=CN=UKManagers,OU=Groups,OU=UK,DC=theitbros,DC=com))
```

## You can list the groups the user is a member of:
```
(&(objectCategory=group)(member=CN=Jon Brion,OU=Employees,DC=theitbros,DC=com))
```

## List all disabled computer accounts in AD:
```
(&(objectClass=computer)(userAccountControl:1.2.840.113556.1.4.803:=2))
```

## Display all Windows 10 computers:
```
(objectCategory=computer)(operatingSystem=Windows 10*)
```

## You can only select computers with a specific build of Windows 10:
```
(&(&(objectCategory=computer)(operatingSystem=Windows 10*)(operatingSystemVersion=*19041*)))
```

Hint. You can map Windows 10 build to version according the following table:
Windows 10 Version	Build number
20H2	19042
2004	19041
1909	18363
1903	18362
1809	17763

## All domain controllers:
```
(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=8192))
```

## All member domain servers (except DCs):
```
(&(objectCategory=computer)(operatingSystem=*server*)(!userAccountControl:1.2.840.113556.1.4.803:=8192))
```

## All MS SQL Server instances in AD:
```
(&(objectCategory=computer)(servicePrincipalName=MSSQLSvc*))
```

## List of groups created for the specified period:
```
(objectCategory=group)(whenCreated>=20200101000000.0Z&<=20201201000000.0Z&)
```

## List all empty AD groups:
```
(objectCategory=group)(!member=*)
```

## List all distribution groups:
```
(&(objectCategory=group)(!groupType:1.2.840.113556.1.4.803:=2147483648))
```

## Print all groups with the *CIO* key in the group name:
```
(objectCategory=group)(samaccountname=*CIO*)
```

## Find all Exchange Servers in the domain:
```
(objectCategory=computer)(servicePrincipalName=exchangeMDB*)(operatingSystem=Windows Server*)
```

## All color printers on a specific print server published in the AD:
```
(uncName=*lon-prnt*)(objectCategory=printQueue)(printColor=TRUE)
```